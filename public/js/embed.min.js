$(function(){$("video").videoPlayer()}),function(e){e.fn.videoPlayer=function(){return/mobile/i.test(navigator.userAgent)?(e("video").css({"min-width":"100%",width:"100%",height:"auto"}),e("video").attr("controls",!0),void 0):this.each(function(){/chrome/i.test(navigator.userAgent)&&e(this).find("source[type='video/mp4']").remove(),e(this)[0].load(),e(this)[0].addEventListener("loadeddata",function(){var s=e(this),t=s.attr("data-width"),i=s.attr("data-height"),n=!1;300>=t||300>=i?(n=!0,s.wrap('<div class="video micro"></div>')):s.wrap('<div class="video"></div>'),s.css({"min-width":"100%",width:"100%",height:"auto","max-width":t+"px"});var r=s.parent(".video");e('<div class="play-button"></div><div class="player"><div class="pause-button"></div><div class="progress"><div class="progress-bar"><div class="button-holder"><div class="progress-button"> </div></div></div></div><div class="time"><span class="ctime">00:00</span><span class="stime"> / </span><span class="ttime">00:00</span></div><div class="volume"><div class="volume-holder"><div class="volume-bar-holder"><div class="volume-bar"><div class="volume-button-holder"><div class="volume-button"> </div></div></div></div></div><div class="volume-icon v-change-0"><span> </span></div></div><div class="fullscreen"> <a href="#"> </a></div></div>').appendTo(r);var o,d,u=e(this)[0],a=u.duration,l=u.volume,c=document.title,f=!1,v=!1,p=!1,m=!1,h=0,g=0,l=u.volume;r.bind("selectstart",function(){return!1});var b=r.find(".progress").width(),w=function(){var s=u.buffered;if(r.find("[class^=buffered]").remove(),s.length>0)for(var t=s.length;t--;){$maxBuffer=s.end(t),$minBuffer=s.start(t);var i=100*($minBuffer/a),n=100*(($maxBuffer-$minBuffer)/a);e('<div class="buffered"></div>').css({left:i+"%",width:n+"%"}).appendTo(r.find(".progress"))}};w();var y=function(){var s=Math.round(e(".progress-bar").width()/b*a),t=u.currentTime,i=0,n=Math.floor(s/60),o=Math.round(a/60),d=Math.round(a-60*o);s&&(i=Math.round(s)-60*n,i>59&&(i=Math.round(s)-60*n,60==i&&(n=Math.round(s/60),i=0))),g=t/a*b,10>i&&(i="0"+i),10>d&&(d="0"+d),r.find(".progress-bar").css({width:g+"px"}),u.currentTime>0?r.find(".progress-button").css({left:g-r.find(".progress-button").width()-15+"px"}):r.find(".progress-button").css({left:g-r.find(".progress-button").width()-5+"px"}),r.find(".ctime").html(n+":"+i),r.find(".ttime").html(o+":"+d),u.currentTime>0&&0==u.paused&&0==u.ended&&w(),document.title=p?"Playing "+n+":"+i+" / "+o+":"+d:u.currentTime>0?"Paused "+n+":"+i+" / "+o+":"+d:c};y(),u.addEventListener("timeupdate",y),e(window).resize(function(){u.currentTime>=a&&(u.currentTime=0),b=r.find(".progress").width(),y(),r.find(".progress-bar").css({width:g+"px"}),u.currentTime>0?r.find(".progress-button").css({left:g-r.find(".progress-button").width()-15+"px"}):r.find(".progress-button").css({left:g-r.find(".progress-button").width()-5+"px"}),w()}),n===!1&&(r.find(".player").css("opacity",1),setTimeout(function(){r.find(".player").css("opacity",0)},3e3)),r.find(".play-button, .pause-button").on("click",function(){p=u.currentTime>0&&0==u.paused&&0==u.ended?!1:!0,0==p?(e(".play-button, .pause-button").removeClass("playing"),u.pause(),w()):(e(".play-button, .pause-button").addClass("playing"),m=!0,u.play())}),r.find(".progress").bind("mousedown",function(e){f=!0,1==p&&u.pause(),h=e.pageX-r.find(".progress").offset().left,o=h/b*a,u.currentTime=o}),e("body, html").bind("mousemove",function(e){if(1!=n&&r.hover(function(){r.find(".player").css("opacity",1)},function(){r.find(".player").css("opacity",0)}),1==f){$draggingProgress=!0;var s=0,t=r.find(".progress-button").width();h=e.pageX-r.find(".progress").offset().left,0>h-15?(s=0,u.currentTime=0):h>b?(u.currentTime=a,s=b):(s=h,o=h/b*a,u.currentTime=o),r.find(".progress-bar").css({width:s+"px"}),u.currentTime>0?r.find(".progress-button").css({left:s-t-15+"px"}):r.find(".progress-button").css({left:s-t-5+"px"})}}),u.addEventListener("ended",function(){p=!1,0==$draggingProgress&&e(".play-button, .pause-button").removeClass("playing")}),r.find(".volume").bind("mousedown",function(){l=u.volume,d===void 0&&(d=u.volume),l>0?(u.volume=0,l=0,r.find(".volume-bar").css({height:"0"}),r.find(".volume").addClass("off")):(u.volume=d,l=d,r.find(".volume-bar").css({height:100*d+"%"}),r.find(".volume").removeClass("off"))}),e("body, html").bind("mouseup",function(){f=!1,v=!1,$draggingProgress=!1,1==p&&u.play(),w()}),u.requestFullscreen||u.mozRequestFullScreen||u.webkitRequestFullScreen||e(".fullscreen").hide(),e(".fullscreen").on("click",function(){u.requestFullscreen?u.requestFullscreen():u.mozRequestFullScreen?u.mozRequestFullScreen():u.webkitRequestFullScreen&&u.webkitRequestFullScreen()})})})}}(jQuery);
