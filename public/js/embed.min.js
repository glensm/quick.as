$(function(){$("video").videoPlayer()}),function(e){e.fn.videoPlayer=function(){return e("video").css({"min-width":"100%",width:"100%",height:"auto"}),/mobile/i.test(navigator.userAgent)?(e(".container").css({padding:"0"}),e("video").attr("controls",!0),void 0):this.each(function(){e(this)[0].load(),e(this)[0].addEventListener("loadeddata",function(){var s=e(this);s.wrap('<div class="video"></div>');var t=s.parent(".video");e('<div class="play-button"></div><div class="player"><div class="pause-button"></div><div class="progress"><div class="progress-bar"><div class="button-holder"><div class="progress-button"> </div></div></div></div><div class="time"><span class="ctime">00:00</span><span class="stime"> / </span><span class="ttime">00:00</span></div><div class="volume"><div class="volume-holder"><div class="volume-bar-holder"><div class="volume-bar"><div class="volume-button-holder"><div class="volume-button"> </div></div></div></div></div><div class="volume-icon v-change-0"><span> </span></div></div><div class="fullscreen"> <a href="#"> </a></div></div>').appendTo(t);var n,i,r=e(this)[0],d=r.duration,o=r.volume,u=document.title,a=!1,l=!1,c=!1,f=!1,v=0,p=0,o=r.volume;t.bind("selectstart",function(){return!1});var m=t.find(".progress").width(),g=function(){var s=r.buffered;if(t.find("[class^=buffered]").remove(),s.length>0)for(var n=s.length;n--;){$maxBuffer=s.end(n),$minBuffer=s.start(n);var i=100*($minBuffer/d),o=100*(($maxBuffer-$minBuffer)/d);e('<div class="buffered"></div>').css({left:i+"%",width:o+"%"}).appendTo(t.find(".progress"))}};g();var b=function(){var s=Math.round(e(".progress-bar").width()/m*d),n=r.currentTime,i=0,o=Math.floor(s/60),a=Math.round(d/60),l=Math.round(d-60*a);s&&(i=Math.round(s)-60*o,i>59&&(i=Math.round(s)-60*o,60==i&&(o=Math.round(s/60),i=0))),p=n/d*m,10>i&&(i="0"+i),10>l&&(l="0"+l),t.find(".progress-bar").css({width:p+"px"}),r.currentTime>0?t.find(".progress-button").css({left:p-t.find(".progress-button").width()-15+"px"}):t.find(".progress-button").css({left:p-t.find(".progress-button").width()-5+"px"}),t.find(".ctime").html(o+":"+i),t.find(".ttime").html(a+":"+l),r.currentTime>0&&0==r.paused&&0==r.ended&&g(),document.title=c?"Playing "+o+":"+i+" / "+a+":"+l:r.currentTime>0?"Paused "+o+":"+i+" / "+a+":"+l:u};b(),r.addEventListener("timeupdate",b),e(window).resize(function(){r.currentTime>=d&&(r.currentTime=0),m=t.find(".progress").width(),b(),t.find(".progress-bar").css({width:p+"px"}),r.currentTime>0?t.find(".progress-button").css({left:p-t.find(".progress-button").width()-15+"px"}):t.find(".progress-button").css({left:p-t.find(".progress-button").width()-5+"px"}),g()}),t.find(".play-button, .pause-button").on("click",function(){c=r.currentTime>0&&0==r.paused&&0==r.ended?!1:!0,0==c?(e(".play-button, .pause-button").removeClass("playing"),r.pause(),g()):(e(".play-button, .pause-button").addClass("playing"),f=!0,r.play())}),t.find(".progress").bind("mousedown",function(e){a=!0,1==c&&r.pause(),v=e.pageX-t.find(".progress").offset().left,n=v/m*d,r.currentTime=n}),e("body, html").bind("mousemove",function(e){if(1==a){$draggingProgress=!0;var s=0,i=t.find(".progress-button").width();v=e.pageX-t.find(".progress").offset().left,0>v-15?(s=0,r.currentTime=0):v>m?(r.currentTime=d,s=m):(s=v,n=v/m*d,r.currentTime=n),t.find(".progress-bar").css({width:s+"px"}),r.currentTime>0?t.find(".progress-button").css({left:s-i-15+"px"}):t.find(".progress-button").css({left:s-i-5+"px"})}}),r.addEventListener("ended",function(){c=!1,0==$draggingProgress&&e(".play-button, .pause-button").removeClass("playing")}),t.find(".volume").bind("mousedown",function(){o=r.volume,i===void 0&&(i=r.volume),o>0?(r.volume=0,o=0,t.find(".volume-bar").css({height:"0"}),t.find(".volume").addClass("off")):(r.volume=i,o=i,t.find(".volume-bar").css({height:100*i+"%"}),t.find(".volume").removeClass("off"))}),e("body, html").bind("mouseup",function(){a=!1,l=!1,$draggingProgress=!1,1==c&&r.play(),g()}),r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullScreen||e(".fullscreen").hide(),e(".fullscreen").on("click",function(){r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullScreen&&r.webkitRequestFullScreen()})})})}}(jQuery);
