$(function(){$("video").videoPlayer(),$("a.embed").on("click",function(){return 0===$("a.embed textarea").length&&($("a.embed span").hide(),$(this).append("<textarea><iframe src='http://"+window.location.host+"/embed"+window.location.pathname+"' scrolling='no' frameborder='0' width='100%'></iframe><script>!function(){function e(){var e=document.getElementsByName('quickcast')\nfor(var n in e){var t=e[n].offsetWidth\ne[n].height=t/1.6+80+'px'}}e(),window.onresize=e}()</script></textarea>")),!1})}),function(e){e.fn.videoPlayer=function(){if(/mobile/i.test(navigator.userAgent)){var t=e(".container").css("padding-left").replace("px","");return e("video").attr("controls",!0).attr("width",window.screen.width-2*parseInt(t)).attr("height",(window.screen.width-2*parseInt(t))/1.6),void 0}return e("video").css({width:"100%",height:"auto"}),this.each(function(){e(this)[0].load(),e(this)[0].addEventListener("loadeddata",function(){var t=e(this);t.wrap('<div class="video"></div>');var n=t.parent(".video");e('<div class="play-button"></div><div class="player"><div class="pause-button"></div><div class="progress"><div class="progress-bar"><div class="button-holder"><div class="progress-button"> </div></div></div></div><div class="time"><span class="ctime">00:00</span><span class="stime"> / </span><span class="ttime">00:00</span></div><div class="volume"><div class="volume-holder"><div class="volume-bar-holder"><div class="volume-bar"><div class="volume-button-holder"><div class="volume-button"> </div></div></div></div></div><div class="volume-icon v-change-0"><span> </span></div></div><div class="fullscreen"> <a href="#"> </a></div></div>').appendTo(n);var s,i,r=e(this)[0],o=r.duration,d=r.volume,a=document.title,u=!1,l=!1,c=!1,f=!1,v=0,p=0,d=r.volume;n.bind("selectstart",function(){return!1});var m=n.find(".progress").width(),h=function(){var t=r.buffered;if(n.find("[class^=buffered]").remove(),t.length>0)for(var s=t.length;s--;){$maxBuffer=t.end(s),$minBuffer=t.start(s);var i=100*($minBuffer/o),d=100*(($maxBuffer-$minBuffer)/o);e('<div class="buffered"></div>').css({left:i+"%",width:d+"%"}).appendTo(n.find(".progress"))}};h();var g=function(){var t=Math.round(e(".progress-bar").width()/m*o),s=r.currentTime,i=0,d=Math.floor(t/60),u=Math.round(o/60),l=Math.round(o-60*u);t&&(i=Math.round(t)-60*d,i>59&&(i=Math.round(t)-60*d,60==i&&(d=Math.round(t/60),i=0))),p=s/o*m,10>i&&(i="0"+i),10>l&&(l="0"+l),n.find(".progress-bar").css({width:p+"px"}),r.currentTime>0?n.find(".progress-button").css({left:p-n.find(".progress-button").width()-15+"px"}):n.find(".progress-button").css({left:p-n.find(".progress-button").width()-5+"px"}),n.find(".ctime").html(d+":"+i),n.find(".ttime").html(u+":"+l),r.currentTime>0&&0==r.paused&&0==r.ended&&h(),document.title=c?"Playing "+d+":"+i+" / "+u+":"+l:r.currentTime>0?"Paused "+d+":"+i+" / "+u+":"+l:a};g(),r.addEventListener("timeupdate",g),e(window).resize(function(){r.currentTime>=o&&(r.currentTime=0),m=n.find(".progress").width(),g(),n.find(".progress-bar").css({width:p+"px"}),r.currentTime>0?n.find(".progress-button").css({left:p-n.find(".progress-button").width()-15+"px"}):n.find(".progress-button").css({left:p-n.find(".progress-button").width()-5+"px"}),h()}),n.find(".play-button, .pause-button").on("click",function(){c=r.currentTime>0&&0==r.paused&&0==r.ended?!1:!0,0==c?(e(".play-button, .pause-button").removeClass("playing"),r.pause(),h()):(e(".play-button, .pause-button").addClass("playing"),f=!0,r.play())}),n.find(".progress").bind("mousedown",function(e){u=!0,1==c&&r.pause(),v=e.pageX-n.find(".progress").offset().left,s=v/m*o,r.currentTime=s}),e("body, html").bind("mousemove",function(e){if(1==u){$draggingProgress=!0;var t=0,i=n.find(".progress-button").width();v=e.pageX-n.find(".progress").offset().left,0>v-15?(t=0,r.currentTime=0):v>m?(r.currentTime=o,t=m):(t=v,s=v/m*o,r.currentTime=s),n.find(".progress-bar").css({width:t+"px"}),r.currentTime>0?n.find(".progress-button").css({left:t-i-15+"px"}):n.find(".progress-button").css({left:t-i-5+"px"})}}),r.addEventListener("ended",function(){c=!1,0==$draggingProgress&&e(".play-button, .pause-button").removeClass("playing")}),n.find(".volume").bind("mousedown",function(){d=r.volume,i===void 0&&(i=r.volume),d>0?(r.volume=0,d=0,n.find(".volume-bar").css({height:"0"}),n.find(".volume").addClass("off")):(r.volume=i,d=i,n.find(".volume-bar").css({height:100*i+"%"}),n.find(".volume").removeClass("off"))}),e("body, html").bind("mouseup",function(){u=!1,l=!1,$draggingProgress=!1,1==c&&r.play(),h()}),r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullScreen||e(".fullscreen").hide(),e(".fullscreen").on("click",function(){r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullScreen&&r.webkitRequestFullScreen()})})})}}(jQuery);
